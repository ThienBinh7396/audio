{"remainingRequest":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/thien/Documents/Tutorials/NodeJs/audio/src/views/pages/ContentChapterRsVAudio2.vue?vue&type=style&index=0&id=05029914&lang=scss&scoped=true&","dependencies":[{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/src/views/pages/ContentChapterRsVAudio2.vue","mtime":1604075048000},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/css-loader/dist/cjs.js","mtime":1596448973331},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1604375615900},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/postcss-loader/src/index.js","mtime":1596448991023},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/sass-loader/dist/cjs.js","mtime":1604042835268},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/cache-loader/dist/cjs.js","mtime":1601544776771},{"path":"/home/thien/Documents/Tutorials/NodeJs/audio/node_modules/vue-loader/lib/index.js","mtime":1604375615900}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi50aXRsZSB7DQogIGNvbG9yOiAjNGY5YmQyOw0KfQ0KDQouY2hhcHRlciAuY2hhcHRlci1jb250ZW50IHAgew0KICBmb250LXNpemU6IGluaGVyaXQ7DQogIGNvbG9yOiAjZGZkZmRmOw0KICBjdXJzb3I6IHBvaW50ZXI7DQp9DQoNCi5jaGFwdGVyIC5jaGFwdGVyLWNvbnRlbnQgcC5hY3RpdmUgew0KICBiYWNrZ3JvdW5kOiAjMmU2MzhhOw0KICBjb2xvcjogI2ZmZjsNCiAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQo="},{"version":3,"sources":["ContentChapterRsVAudio2.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyqBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"ContentChapterRsVAudio2.vue","sourceRoot":"src/views/pages","sourcesContent":["<template>\r\n<v-row>\r\n  <v-col cols=\"12\" class=\"relative\">\r\n    <loading-icon w=\"82\" margin=\"160px auto 0\" v-if=\"loading\"></loading-icon>\r\n    <loading-circular-dialog :show=\"loadingNewChapter\" />\r\n\r\n    <div class=\"d-none\">\r\n      <audio preload=\"metadata\" id=\"speech-audio\" @loadstart=\"loadstart('audio')\" @error=\"error('audio')\" @ended=\"ended('audio')\" @play=\"play('audio')\" @playing=\"playing('audio')\" />\r\n      <audio preload=\"metadata\" id=\"speech-audio-another\" @loadstart=\"loadstart('audioAnother')\" @error=\"error('audioAnother')\" @ended=\"ended('audioAnother')\" @play=\"play('audioAnother')\" @playing=\"playing('audioAnother')\" />\r\n    </div>\r\n\r\n    <div class=\"tb-dialog\" :class=\"{show: dialog}\" v-if=\"!loading\">\r\n      <div class=\"tb-dialog-overplay\" @click=\"dialog = false\" />\r\n      <v-card class=\"dialog-chapter-content\" id=\"js-dialog-chapter-content\">\r\n        <chapter :dialog=\"true\" @getChapter=\"getChapters\" :current=\"Number(chapter_id)\" :story_id=\"storyInfo.id\" :story_url=\"storyInfo.url_story\" />\r\n      </v-card>\r\n    </div>\r\n\r\n    <div class=\"tb-dialog\" :class=\"{show: dialogSetting}\" v-if=\"!loading \">\r\n      <div class=\"tb-dialog-overplay\" @click=\"dialogSetting = false\" />\r\n      <v-card class=\"dialog-setting-content \">\r\n        <v-card-title class=\"px-3 py-2 text-blur\">Cấu Hình: </v-card-title>\r\n        <user-config-dialog class=\"px-3\" />\r\n      </v-card>\r\n\r\n    </div>\r\n\r\n    <div class=\"tb-dialog\" :class=\"{show: dialogTimer}\" v-if=\"!loading \">\r\n      <div class=\"tb-dialog-overplay\" @click=\"dialogTimer = false\" />\r\n      <v-card class=\"dialog-setting-content \">\r\n        <v-card-title class=\"px-3 pt-1 py-2 text-blur\">Hẹn giờ tắt: </v-card-title>\r\n        <v-text-field class=\"px-4 mt-1\" id=\"countdown-timer-input\" type=\"number\" min=\"1\" max=\"720\" @keydown=\"checkNumber($event)\" @keyup=\"checkMax()\" @change=\"checkMax()\" @blur=\"checkMax()\" @focus=\"checkMax()\" label=\"Điền số phút...\" solo single-line outlined dense></v-text-field>\r\n        <div class=\"px-4 mb-4\">\r\n          <v-btn small color=\"#1e9022\" @click=\"startCountDownTimer()\">Bắt đầu</v-btn>\r\n        </div>\r\n      </v-card>\r\n    </div>\r\n\r\n    <div class=\"countdown-timer\" v-show=\"showTimer\" :class=\"{sticky: currentScrollPoint > 180}\">\r\n      <div class=\"countdown-timer-chapter\">\r\n\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"chapter px-0 px-md-5 px-lg-10\" v-if=\"!loading\">\r\n      <h1 class=\"mt-2 text-center\">{{storyInfo.title_story}}</h1>\r\n      <div class=\"title text-center\">{{storyInfo.chapter}}</div>\r\n      <div class=\"chapter-content mt-12 mb-12\" :style=\"{'font-size': `${config.fontSize}px`}\">\r\n        <p :class=\"{active: index == currentLine }\" @click=\"startSpeakLine(index)\" class=\"px-3\" v-for=\"(line, index) in storyInfo.content\" :key=\"`line-${index}`\" :id=\"`js-line-${index}`\" v-html=\"line\">\r\n        </p>\r\n      </div>\r\n      <div class=\"control-box d-flex justify-space-between px-6  mt-4 mb-12\">\r\n        <v-btn outlined @click=\"prevChapter()\" v-if=\"getIndex() != 0\">\r\n          <v-icon class=\"mr-1\">mdi-arrow-left</v-icon>\r\n          Previous\r\n        </v-btn>\r\n        <v-btn outlined @click=\"nextChapter()\" v-if=\"getIndex() != chapters.length - 1\">\r\n          Next\r\n          <v-icon class=\"ml-1\">mdi-arrow-right</v-icon>\r\n        </v-btn>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"button-action-group\" v-if=\"!detectMobile\">\r\n      <v-speed-dial v-model=\"fab\" top direction=\"top\" :open-on-hover=\"false\" transition=\"slide-y-reverse-transition\">\r\n        <template v-slot:activator>\r\n          <v-btn v-model=\"fab\" color=\"#1088ff\" dark fab>\r\n            <v-icon v-if=\"fab\">mdi-close</v-icon>\r\n            <v-icon v-else size=\"26\">mdi-gesture-double-tap</v-icon>\r\n          </v-btn>\r\n        </template>\r\n        <v-btn class=\"size-default \" color=\"#2740e0\" dark fab @click.stop=\"startSpeak()\">\r\n          <radio-gif width=\"32\" v-if=\"reading\" style=\"margin-right: -2px; margin-top: -2px\" />\r\n          <v-icon v-if=\"!reading\">mdi-headphones-settings</v-icon>\r\n        </v-btn>\r\n        <v-btn color=\"#FF8D00FF\" small dark fab @click.stop=\"dialog = true\">\r\n          <v-icon>mdi-format-list-bulleted</v-icon>\r\n        </v-btn>\r\n        <v-btn color=\"#ff0000\" small dark fab @click.stop=\"dialogTimer = true\">\r\n          <v-icon>mdi-timer</v-icon>\r\n        </v-btn>\r\n        <v-btn color=\"#529e33\" small dark fab @click.stop=\"dialogSetting = true\">\r\n          <v-icon class=\"ld xhalf ld-spin \">mdi-cog</v-icon>\r\n        </v-btn>\r\n        <v-btn color=\"#F44336\" small dark fab @click.stop=\"scrollToTop()\">\r\n          <v-icon class=\"ld ld-jump\" :class=\"{'mt-1': !scrollTop }\">{{scrollTop ? 'mdi-chevron-up' : 'mdi-chevron-down'}}</v-icon>\r\n        </v-btn>\r\n\r\n      </v-speed-dial>\r\n\r\n    </div>\r\n    <div class=\"mobile-action\" v-if=\"detectMobile\">\r\n      <div class=\"bottom-button-control\">\r\n        <div @click.stop=\"scrollToTop()\">\r\n          <v-icon class=\"ld ld-jump\" :class=\"{'mt-1': !scrollTop }\">{{scrollTop ? 'mdi-chevron-up' : 'mdi-chevron-down'}}</v-icon>\r\n        </div>\r\n        <div @click.stop=\"dialogSetting = true\">\r\n          <v-icon class=\"ld xhalf ld-spin \">mdi-settings</v-icon>\r\n        </div>\r\n        <div @click.stop=\"dialogTimer = true\">\r\n          <v-icon class=\"ld ld-jingle\">mdi-timer</v-icon>\r\n        </div>\r\n        <div @click.stop=\"$store.commit('app/setShowSearch', true)\">\r\n          <v-icon class=\"ld ld-tremble\">mdi-magnify</v-icon>\r\n        </div>\r\n        <div @click.stop=\"dialog = true\">\r\n          <v-icon>mdi-format-list-bulleted</v-icon>\r\n        </div>\r\n      </div>\r\n      <div class=\"button-audio-control\">\r\n        <v-btn class=\"size-default \" color=\"#2740e0\" dark fab @click.stop=\"startSpeak()\">\r\n          <radio-gif width=\"32\" v-if=\"reading\" style=\"margin-right: -2px; margin-top: -2px\" />\r\n          <v-icon v-if=\"!reading\">mdi-headphones-settings</v-icon>\r\n        </v-btn>\r\n      </div>\r\n    </div>\r\n\r\n  </v-col>\r\n</v-row>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  mapState,\r\n  mapActions,\r\n  mapMutations\r\n} from 'vuex';\r\n\r\nexport default {\r\n  components: {\r\n    Chapter: () =>\r\n      import('@/views/partials/Chapters'),\r\n\r\n    UserConfigDialog: () =>\r\n      import('@/views/partials/UserConfigDialog.vue')\r\n  },\r\n  data() {\r\n    return {\r\n      fab: true,\r\n      dialog: false,\r\n      dialogSetting: false,\r\n      dialogSearch: false,\r\n      dialogTimer: false,\r\n      showTimer: false,\r\n      countDown: null,\r\n      story_url: '',\r\n      chapter_url: '',\r\n      chapter_id: -1,\r\n      storyInfo: {},\r\n      chapters: [],\r\n      loading: false,\r\n      loadingNewChapter: false,\r\n      currentLine: 0,\r\n      pathInLine: [],\r\n      reading: false,\r\n      voice: 'Vietnamese Female',\r\n      scrollTop: false,\r\n      currentScrollPoint: 0,\r\n      audio: null,\r\n      audioCountError: 0,\r\n      audioAnother: null,\r\n      audioAnotherCountError: 0,\r\n      currentAudio: 'audio'\r\n    }\r\n  },\r\n  created() {\r\n    this.init();\r\n\r\n  },\r\n  computed: {\r\n    ...mapState('app', ['config', 'detectMobile', 'recentStories']),\r\n  },\r\n  watch: {\r\n    $route: function (val) {\r\n      this.dialog = false;\r\n\r\n      this.init();\r\n    },\r\n    config: function (val) {\r\n      console.log('Audio: ');\r\n      console.log(val);\r\n\r\n      this.updateConfig();\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations('app', ['setNav', 'setTitle', 'setShowSearch', 'setTopBackground']),\r\n    ...mapActions('app', ['showToast', 'updateRecentlyStory']),\r\n    init: function () {\r\n      let {\r\n        story_url,\r\n        chapter_url,\r\n        chapter_id\r\n      } = this.$route.params;\r\n\r\n      this.story_url = story_url;\r\n      this.chapter_url = chapter_url;\r\n      this.chapter_id = chapter_id;\r\n\r\n      this.loading = true;\r\n      this.loadContent();\r\n    },\r\n    loadContent: function () {\r\n      this.$axios.get(`/story/read`, {\r\n          params: {\r\n            story_url: this.story_url,\r\n            chapter_url: this.chapter_url\r\n          }\r\n        })\r\n        .then(rs => {\r\n          let {\r\n            data\r\n          } = rs;\r\n\r\n          if (data.type == 'error' || data.data.id == null || !data.data.title_story) {\r\n            this.$router.push('/404');\r\n            return;\r\n          }\r\n\r\n          this.loading = false;\r\n          this.loadingNewChapter = false;\r\n\r\n          let contents = data.data.content.split(/\\n+/).filter(it => it && it.trim().length != '');\r\n\r\n          data.data.content = contents;\r\n\r\n          this.storyInfo = data.data;\r\n          this.currentLine = 0;\r\n\r\n          if (this.reading) {\r\n            this.currentAudio = 'audio';\r\n\r\n            this.audio.src = this.getUrl(this.currentLine);\r\n\r\n            this.speak();\r\n\r\n          }\r\n\r\n          this.setNav([{\r\n              path: '/',\r\n              text: 'Trang chủ'\r\n            },\r\n            {\r\n              path: `/story/${this.storyInfo.url_story}/${this.storyInfo.id}`,\r\n              text: this.storyInfo.title_story\r\n            },\r\n            {\r\n              path: ``,\r\n              text: this.storyInfo.chapter\r\n            },\r\n\r\n          ])\r\n\r\n          this.setTitle(`${this.storyInfo.title_story} - ${this.storyInfo.chapter}`);\r\n\r\n          window.history.replaceState({}, \"\", `/read/story/${this.story_url}/${this.chapter_url}/${this.chapter_id}`);\r\n\r\n          this.scrollToTop(true);\r\n\r\n          if (this.reading) this.speak();\r\n\r\n          this.updateRecentlyStory({\r\n            storyInfo: this.storyInfo,\r\n            chapterId: this.$route.params.chapter_id,\r\n            chapterHref: this.$route.params.chapter_url\r\n          });\r\n\r\n          let index = this.recentStories.findIndex(it => it.id == this.storyInfo.id);\r\n\r\n          if (index >= 0) {\r\n            this.setTopBackground(imageUrl(this.recentStories[index].image));\r\n          }\r\n\r\n        })\r\n    },\r\n    updateConfig: function () {\r\n      if (this.audio) {\r\n        this.audio.volume = this.config.volume;\r\n        this.audio.playbackRate = this.config.speed;\r\n      }\r\n\r\n      if (this.audioAnother) {\r\n        this.audioAnother.volume = this.config.volume;\r\n        this.audioAnother.playbackRate = this.config.speed;\r\n      }\r\n\r\n    },\r\n    select: function () {\r\n      let selectText = '';\r\n\r\n      if (window.getSelection) {\r\n        console.log(window.getSelection);\r\n        selectText = window.getSelection().toString();\r\n      } else if (document.selection) {\r\n        console.log(document.selection);\r\n        selectText = document.selection.createRange().text;\r\n      }\r\n\r\n      if (selectText.length != 0) {\r\n        this.speak(selectText, false);\r\n      }\r\n\r\n    },\r\n    startSpeak: function (speak = true) {\r\n\r\n      this.reading = !this.reading;\r\n      if (!speak) this.reading = false;\r\n\r\n      if (this.reading) {\r\n        if (this.currentLine == 0) {\r\n          this.audio.src = this.getUrl(this.currentLine);\r\n\r\n          this.speak();\r\n\r\n        } else {\r\n          this[this.currentAudio].play();\r\n\r\n        }\r\n\r\n      } else {\r\n        this.audio.pause();\r\n        this.audioAnother.pause();\r\n\r\n      }\r\n    },\r\n    loadstart: function (ref) {\r\n      console.log(ref);\r\n\r\n    },\r\n    play: function (ref) {\r\n      this.updateConfig();\r\n\r\n    },\r\n    playing: function (ref) {\r\n      if (ref == 'audio') {\r\n        this.audioCountError = 0;\r\n      } else {\r\n        this.audioAnotherCountError = 0;\r\n\r\n      }\r\n\r\n      if (this.currentAudio != ref) {\r\n\r\n        this[ref].pause();\r\n        this[ref].currentTime = 0;\r\n\r\n      }\r\n\r\n    },\r\n    ended: function () {\r\n      if (this.currentLine == this.storyInfo.content.length - 1 && this.getIndex() != this.chapters.length - 1) {\r\n        responsiveVoice.speak(`Chương tiếp! ${this.chapters[this.getIndex() + 1].title}}`, this.voice, {\r\n          rate: 1.3\r\n        });\r\n\r\n        setTimeout(() => {\r\n          this.next();\r\n\r\n        }, 2500);\r\n\r\n      } else {\r\n        this.next();\r\n      }\r\n\r\n    },\r\n    error: function (ref) {\r\n      console.log(\"error: \" + ref);\r\n\r\n      setTimeout(() => {\r\n\r\n        let text = this[ref].src.match(/\\?text=(?<text>.*?)&/)[1];\r\n\r\n        if (text[text.length - 1] == '.') {\r\n          text = text.substring(0, text.length - 1)\r\n        } else {\r\n          text = `${text}.`\r\n        }\r\n\r\n        let check = false;\r\n\r\n        if (ref == 'audio') {\r\n          this.audioCountError++;\r\n          if (this.audioCountError >= 2) {\r\n            check = true;\r\n\r\n          }\r\n        } else {\r\n          this.audioAnotherCountError++;\r\n\r\n          if (this.audioAnotherCountError >= 2) {\r\n            check = true;\r\n\r\n          }\r\n        }\r\n\r\n        if (this.currentAudio == ref && check) {\r\n\r\n          console.log(this.currentLine);\r\n          this.audioAnotherCountError = 0;\r\n          this.audioCountError = 0;\r\n          this.next();\r\n\r\n        } else {\r\n          this[ref].src = this.getUrlWithText(text);\r\n\r\n          if (this.currentAudio == ref) {\r\n            this[ref].load();\r\n            this[ref].play();\r\n          }\r\n        }\r\n\r\n      }, 1500)\r\n    },\r\n    getUrl: function (index) {\r\n      let text = encodeURI(this.storyInfo.content[index]);\r\n      //let text = this.storyInfo.content[index];\r\n\r\n      console.log(this.storyInfo.content[index]);\r\n\r\n      // if (text[text.length - 1] == '.') {\r\n      //     text = text.substring(0, text.length - 1)\r\n      // }\r\n\r\n      return `https://code.responsivevoice.org/getvoice.php?text=${text}&lang=vi&engie=g1&rate=0.53&volume=1&key=uu8DEkxz&gender=female`\r\n      //return `https://texttospeech.responsivevoice.org/v1/text:synthesize?text=${text}&lang=vi&engine=g1&rate=0.53&volume=1&key=32hDX4HJ&gender=female`\r\n    },\r\n    getUrlWithText: function (text) {\r\n      return `https://code.responsivevoice.org/getvoice.php?text=${text}&lang=vi&engie=g1&rate=0.53&volume=1&key=uu8DEkxz&gender=female`\r\n      //return `https://texttospeech.responsivevoice.org/v1/text:synthesize?text=${text}&lang=vi&engine=g1&rate: 0.53&volume=1&key=32hDX4HJ&gender=female`\r\n    },\r\n    speak: function () {\r\n\r\n      let a = this.currentAudio == 'audio' ? 'audioAnother' : 'audio';\r\n\r\n      this[a].src = this.currentLine == this.storyInfo.content.length - 1 ? '/audio/temp-audio.mp3' : this.getUrl(this.currentLine + 1);\r\n\r\n      this[a].load();\r\n\r\n      //console.log(this[a]);\r\n\r\n      this[this.currentAudio].play();\r\n\r\n      this.scrollText();\r\n    },\r\n    startSpeakLine: function (index) {\r\n      if (this.currentLine == index) {\r\n        this.startSpeak();\r\n\r\n        return;\r\n      }\r\n\r\n      if (!this.reading) {\r\n        this.reading = true;\r\n      }\r\n      this.currentLine = index;\r\n      this.currentAudio = 'audio';\r\n\r\n      this.audio.src = this.getUrl(this.currentLine);\r\n\r\n      this.speak();\r\n    },\r\n    next: function () {\r\n      this.currentLine++;\r\n      console.log('Next: ' + this.currentLine);\r\n\r\n      this.currentAudio = this.currentAudio == 'audio' ? 'audioAnother' : 'audio';\r\n\r\n      if (this.currentLine == this.storyInfo.content.length) {\r\n        console.log('End chapter');\r\n\r\n        this.nextChapter();\r\n\r\n        return;\r\n      }\r\n\r\n      this.speak();\r\n    },\r\n\r\n    nextChapter: function () {\r\n\r\n      if (this.chapters.length == 0) {\r\n        this.showToast({\r\n          type: 'info',\r\n          text: 'Chương cuối!'\r\n        });\r\n\r\n        this.loadingNewChapter = false;\r\n        return;\r\n      }\r\n      let index = this.getIndex();\r\n\r\n      if (index != this.chapters.length - 1) {\r\n        this.chapter_id = this.chapters[index + 1].chapterId;\r\n        this.chapter_url = this.chapters[index + 1].href;\r\n\r\n        if (this.loadingNewChapter) return;\r\n\r\n        this.loadingNewChapter = true;\r\n\r\n        this.loadContent();\r\n      } else {\r\n        this.showToast({\r\n          type: 'info',\r\n          text: 'Chương cuối!'\r\n        })\r\n      }\r\n      console.log(this.chapter_id, index);\r\n\r\n    },\r\n    prevChapter: function () {\r\n      this.loadingNewChapter = true;\r\n\r\n      if (this.chapters.length == 0) {\r\n        this.showToast({\r\n          type: 'info',\r\n          text: 'Chương cuối!'\r\n        });\r\n\r\n        this.loadingNewChapter = false;\r\n        return;\r\n      }\r\n      let index = this.getIndex();\r\n\r\n      if (index != 0) {\r\n        this.chapter_id = this.chapters[index - 1].chapterId;\r\n        this.chapter_url = this.chapters[index - 1].href;\r\n\r\n        this.loadContent();\r\n      } else {\r\n        this.showToast({\r\n          type: 'info',\r\n          text: 'Chương đầu tiên. Không thể trở về!'\r\n        })\r\n      }\r\n      console.log(this.chapter_id, index);\r\n\r\n    },\r\n    scrollText: function () {\r\n      let objDiv = document.getElementById(`js-line-${this.currentLine}`);\r\n      if (!objDiv) return;\r\n\r\n      $(document.body).animate({\r\n        scrollTop: objDiv.offsetTop\r\n      }, 100)\r\n\r\n    },\r\n    scrollToTop: function (onlyTop) {\r\n\r\n      let height = document.getElementById(`main-content`).offsetHeight;\r\n\r\n      let div = document.body;\r\n\r\n      if (onlyTop) {\r\n        $(div).animate({\r\n          scrollTop: -height\r\n        }, 300)\r\n\r\n        return;\r\n      }\r\n\r\n      $(div).animate({\r\n        scrollTop: this.scrollTop ? -height : height,\r\n      }, 300)\r\n\r\n    },\r\n    scrollTo: function (num) {\r\n      let offset = document.body.scrollTop + num;\r\n\r\n      $(document.body).animate({\r\n        scrollTop: offset\r\n      }, 100)\r\n    },\r\n    getChapters: function (chaps) {\r\n      this.chapters = chaps;\r\n    },\r\n    getIndex: function () {\r\n      return this.chapters.findIndex(it => it.chapterId == this.chapter_id);\r\n    },\r\n    checkNumber: function ($event) {\r\n      return $event.keyCode >= 48 && $event.keyCode <= 57;\r\n    },\r\n    checkMax: function () {\r\n      let timerInput = document.getElementById('countdown-timer-input');\r\n      let num = Number(timerInput.value);\r\n\r\n      if (num > 720) {\r\n        timerInput.value = 720;\r\n      }\r\n    },\r\n    startCountDownTimer: function () {\r\n      let timerInput = document.getElementById('countdown-timer-input');\r\n      let num = Number(timerInput.value);\r\n\r\n      if (num == 0) {\r\n        this.showToast({\r\n          type: 'warning',\r\n          text: 'Xin hãy nhập số phút lớn hơn 0!'\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.dialogTimer = false;\r\n\r\n      this.showCountDownTimer(Date.now() + num * 60 * 1000);\r\n\r\n    },\r\n    showCountDownTimer: function (time) {\r\n      let that = this;\r\n\r\n      that.showTimer = true;\r\n\r\n      this.countDown = new Countdown({\r\n        cont: document.querySelector('.countdown-timer-chapter'),\r\n        date: time,\r\n        outputTranslation: {\r\n          hour: '',\r\n          minute: '',\r\n          second: '',\r\n        },\r\n        endCallback: function () {\r\n          that.showTimer = false;\r\n\r\n          that.startSpeak(false);\r\n\r\n          that.showToast({\r\n            type: 'error',\r\n            text: 'Hết giờ!'\r\n          })\r\n\r\n        },\r\n        outputFormat: 'hour|minute|second',\r\n      });\r\n\r\n      this.countDown.start();\r\n\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log('Mounted');\r\n\r\n    this.audio = document.getElementById('speech-audio');\r\n    this.audioAnother = document.getElementById('speech-audio-another');\r\n\r\n    this.updateConfig();\r\n\r\n    document.body.addEventListener('scroll', () => {\r\n      this.scrollTop = document.body.scrollTop < this.currentScrollPoint;\r\n\r\n      this.currentScrollPoint = document.body.scrollTop;\r\n\r\n    })\r\n\r\n    window.addEventListener('keyup', (event) => {\r\n\r\n      if (event.keyCode == 37) {\r\n        this.prevChapter();\r\n      }\r\n      if (event.keyCode == 39) {\r\n        this.nextChapter();\r\n      }\r\n\r\n      if (event.keyCode == 38) {\r\n        this.scrollTo(-240);\r\n      }\r\n      if (event.keyCode == 40) {\r\n        this.scrollTo(240);\r\n      }\r\n    })\r\n  },\r\n  destroyed() {\r\n    this.audio.pause();\r\n    this.audio.currentTime = 0;\r\n\r\n    this.audioAnother.pause();\r\n    this.audioAnother.currentTime = 0;\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.title {\r\n  color: #4f9bd2;\r\n}\r\n\r\n.chapter .chapter-content p {\r\n  font-size: inherit;\r\n  color: #dfdfdf;\r\n  cursor: pointer;\r\n}\r\n\r\n.chapter .chapter-content p.active {\r\n  background: #2e638a;\r\n  color: #fff;\r\n  user-select: none;\r\n}\r\n</style>\r\n"]}]}